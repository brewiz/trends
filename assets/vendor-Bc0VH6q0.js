const e=Symbol("solid-proxy"),n=Symbol("solid-track"),t={equals:(e,n)=>e===n};let r=C;const o=1,s=2,u={owned:null,cleanups:null,context:null,owner:null},l={};var c=null;let i=null,a=null,f=null,d=null,h=0;function p(e,n){const t=a,r=c,o=0===e.length,s=void 0===n?r:n,l=o?u:{owned:null,cleanups:null,context:s?s.context:null,owner:s},i=o?e:()=>e((()=>S((()=>J(l)))));c=l,a=null;try{return B(i,!0)}finally{a=t,c=r}}function v(e,n){const r={value:e,observers:null,observerSlots:null,comparator:(n=n?Object.assign({},t,n):t).equals||void 0};return[H.bind(r),e=>("function"==typeof e&&(e=e(r.value)),P(r,e))]}function g(e,n,t){$(U(e,n,!1,o))}function b(e,n,t){r=D;const s=U(e,n,!1,o);t&&t.render||(s.user=!0),d?d.push(s):$(s)}function y(e,n,r){r=r?Object.assign({},t,r):t;const o=U(e,n,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=r.equals||void 0,$(o),H.bind(o)}function w(e,n,t){let r,s,u;"function"==typeof n?(r=e,s=n,u={}):(r=!0,s=e,u=n||{});let c=null,i=l,f=!1,d="initialValue"in u,h="function"==typeof r&&y(r);const p=new Set,[g,b]=(u.storage||v)(u.initialValue),[w,A]=v(void 0),[k,m]=v(void 0,{equals:!1}),[x,q]=v(d?"ready":"unresolved");function O(e,n,t,r){return c===e&&(c=null,void 0!==r&&(d=!0),e!==i&&n!==i||!u.onHydrated||queueMicrotask((()=>u.onHydrated(r,{value:n}))),i=l,function(e,n){B((()=>{void 0===n&&b((()=>e)),q(void 0!==n?"errored":d?"ready":"unresolved"),A(n);for(const e of p.keys())e.decrement();p.clear()}),!1)}(n,t)),n}function j(){const e=g(),n=w();if(void 0!==n&&!c)throw n;return a&&a.user,e}function E(e=!0){if(!1!==e&&f)return;f=!1;const n=h?h():r;if(null==n||!1===n)return void O(c,S(g));const t=i!==l?i:S((()=>s(n,{value:g(),refetching:e})));return(o=t)&&"object"==typeof o&&"then"in o?(c=t,"value"in t?("success"===t.status?O(c,t.value,void 0,n):O(c,void 0,K(t.value),n),t):(f=!0,queueMicrotask((()=>f=!1)),B((()=>{q(d?"refreshing":"pending"),m()}),!1),t.then((e=>O(t,e,void 0,n)),(e=>O(t,void 0,K(e),n))))):(O(c,t,void 0,n),t);var o}return Object.defineProperties(j,{state:{get:()=>x()},error:{get:()=>w()},loading:{get(){const e=x();return"pending"===e||"refreshing"===e}},latest:{get(){if(!d)return j();const e=w();if(e&&!c)throw e;return g()}}}),h?function(e,n){$(U(e,n,!0,o))}((()=>E(!1))):E(!1),[j,{refetch:E,mutate:b}]}function A(e){return B(e,!1)}function S(e){if(null===a)return e();const n=a;a=null;try{return e()}finally{a=n}}function k(e){b((()=>S(e)))}function m(e){return null===c||(null===c.cleanups?c.cleanups=[e]:c.cleanups.push(e)),e}function x(){return a}function q(){return c}function O(e,n){const t=c,r=a;c=e,a=null;try{return B(n,!0)}catch(o){L(o)}finally{c=t,a=r}}const[j,E]=v(!1);function M(e,n){const t=Symbol("context");return{id:t,Provider:Q(t),defaultValue:e}}function V(e){let n;return c&&c.context&&void 0!==(n=c.context[e.id])?n:e.defaultValue}function F(e){const n=y(e),t=y((()=>N(n())));return t.toArray=()=>{const e=t();return Array.isArray(e)?e:null!=e?[e]:[]},t}function H(){if(this.sources&&this.state)if(this.state===o)$(this);else{const e=f;f=null,B((()=>G(this)),!1),f=e}if(a){const e=this.observers?this.observers.length:0;a.sources?(a.sources.push(this),a.sourceSlots.push(e)):(a.sources=[this],a.sourceSlots=[e]),this.observers?(this.observers.push(a),this.observerSlots.push(a.sources.length-1)):(this.observers=[a],this.observerSlots=[a.sources.length-1])}return this.value}function P(e,n,t){let r=e.value;return e.comparator&&e.comparator(r,n)||(e.value=n,e.observers&&e.observers.length&&B((()=>{for(let n=0;n<e.observers.length;n+=1){const t=e.observers[n],r=i&&i.running;r&&i.disposed.has(t),(r?t.tState:t.state)||(t.pure?f.push(t):d.push(t),t.observers&&I(t)),r||(t.state=o)}if(f.length>1e6)throw f=[],new Error}),!1)),n}function $(e){if(!e.fn)return;J(e);const n=h;!function(e,n,t){let r;const s=c,u=a;a=c=e;try{r=e.fn(n)}catch(l){return e.pure&&(e.state=o,e.owned&&e.owned.forEach(J),e.owned=null),e.updatedAt=t+1,L(l)}finally{a=u,c=s}(!e.updatedAt||e.updatedAt<=t)&&(null!=e.updatedAt&&"observers"in e?P(e,r):e.value=r,e.updatedAt=t)}(e,e.value,n)}function U(e,n,t,r=o,s){const l={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:n,owner:c,context:c?c.context:null,pure:t};return null===c||c!==u&&(c.owned?c.owned.push(l):c.owned=[l]),l}function z(e){if(0===e.state)return;if(e.state===s)return G(e);if(e.suspense&&S(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<h);)e.state&&n.push(e);for(let t=n.length-1;t>=0;t--)if((e=n[t]).state===o)$(e);else if(e.state===s){const t=f;f=null,B((()=>G(e,n[0])),!1),f=t}}function B(e,n){if(f)return e();let t=!1;n||(f=[]),d?t=!0:d=[],h++;try{const n=e();return function(e){f&&(C(f),f=null);if(e)return;const n=d;d=null,n.length&&B((()=>r(n)),!1)}(t),n}catch(o){t||(d=null),f=null,L(o)}}function C(e){for(let n=0;n<e.length;n++)z(e[n])}function D(e){let n,t=0;for(n=0;n<e.length;n++){const r=e[n];r.user?e[t++]=r:z(r)}for(n=0;n<t;n++)z(e[n])}function G(e,n){e.state=0;for(let t=0;t<e.sources.length;t+=1){const r=e.sources[t];if(r.sources){const e=r.state;e===o?r!==n&&(!r.updatedAt||r.updatedAt<h)&&z(r):e===s&&G(r,n)}}}function I(e){for(let n=0;n<e.observers.length;n+=1){const t=e.observers[n];t.state||(t.state=s,t.pure?f.push(t):d.push(t),t.observers&&I(t))}}function J(e){let n;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),t=e.sourceSlots.pop(),r=n.observers;if(r&&r.length){const e=r.pop(),o=n.observerSlots.pop();t<r.length&&(e.sourceSlots[o]=t,r[t]=e,n.observerSlots[t]=o)}}if(e.tOwned){for(n=e.tOwned.length-1;n>=0;n--)J(e.tOwned[n]);delete e.tOwned}if(e.owned){for(n=e.owned.length-1;n>=0;n--)J(e.owned[n]);e.owned=null}if(e.cleanups){for(n=e.cleanups.length-1;n>=0;n--)e.cleanups[n]();e.cleanups=null}e.state=0}function K(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}function L(e,n=c){throw K(e)}function N(e){if("function"==typeof e&&!e.length)return N(e());if(Array.isArray(e)){const n=[];for(let t=0;t<e.length;t++){const r=N(e[t]);Array.isArray(r)?n.push.apply(n,r):n.push(r)}return n}return e}function Q(e,n){return function(n){let t;return g((()=>t=S((()=>(c.context={...c.context,[e]:n.value},F((()=>n.children)))))),void 0),t}}const R=Symbol("fallback");function T(e){for(let n=0;n<e.length;n++)e[n]()}function W(e,n){return S((()=>e(n||{})))}function X(e){const t="fallback"in e&&{fallback:()=>e.fallback};return y(function(e,t,r={}){let o=[],s=[],u=[],l=0,c=t.length>1?[]:null;return m((()=>T(u))),()=>{let i,a,f=e()||[],d=f.length;return f[n],S((()=>{let e,n,t,v,g,b,y,w,A;if(0===d)0!==l&&(T(u),u=[],o=[],s=[],l=0,c&&(c=[])),r.fallback&&(o=[R],s[0]=p((e=>(u[0]=e,r.fallback()))),l=1);else if(0===l){for(s=new Array(d),a=0;a<d;a++)o[a]=f[a],s[a]=p(h);l=d}else{for(t=new Array(d),v=new Array(d),c&&(g=new Array(d)),b=0,y=Math.min(l,d);b<y&&o[b]===f[b];b++);for(y=l-1,w=d-1;y>=b&&w>=b&&o[y]===f[w];y--,w--)t[w]=s[y],v[w]=u[y],c&&(g[w]=c[y]);for(e=new Map,n=new Array(w+1),a=w;a>=b;a--)A=f[a],i=e.get(A),n[a]=void 0===i?-1:i,e.set(A,a);for(i=b;i<=y;i++)A=o[i],a=e.get(A),void 0!==a&&-1!==a?(t[a]=s[i],v[a]=u[i],c&&(g[a]=c[i]),a=n[a],e.set(A,a)):u[i]();for(a=b;a<d;a++)a in t?(s[a]=t[a],u[a]=v[a],c&&(c[a]=g[a],c[a](a))):s[a]=p(h);s=s.slice(0,l=d),o=f.slice(0)}return s}));function h(e){if(u[a]=e,c){const[e,n]=v(a);return c[a]=n,t(f[a],e)}return t(f[a])}}}((()=>e.each),e.children,t||void 0))}function Y(e){const n=e.keyed,t=y((()=>e.when),void 0,void 0),r=n?t:y(t,void 0,{equals:(e,n)=>!e==!n});return y((()=>{const o=r();if(o){const s=e.children;return"function"==typeof s&&s.length>0?S((()=>s(n?o:()=>{if(!S(r))throw`Stale read from <${"Show"}>.`;return t()}))):s}return e.fallback}),void 0,void 0)}export{e as $,X as F,Y as S,g as a,b,p as c,v as d,y as e,A as f,q as g,n as h,x as i,V as j,k,W as l,M as m,w as n,m as o,O as r,S as u};
